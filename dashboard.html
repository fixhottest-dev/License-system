<!DOCTYPE html>
<html>
<head>
    <title>Admin Control Panel - THE-F!X_King</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: #0a0a0a; 
            font-family: 'Courier New', monospace; 
            color: #ffffff; 
            padding: 20px;
            min-height: 100vh;
        }
        .admin-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: #000000;
            border-radius: 10px;
            border: 2px solid #ff0000;
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.5);
            position: relative;
        }
        .admin-header::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #ff0000, #ff3333, #ff0000);
            border-radius: 12px;
            z-index: -1;
            animation: borderGlow 2s ease-in-out infinite;
        }
        @keyframes borderGlow {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .admin-header h1 { 
            color: #ff0000; 
            margin-bottom: 10px;
            text-shadow: 0 0 10px #ff0000;
            font-size: 24px;
        }
        .config-section {
            background: #000000;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #ff0000;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
        }
        .config-section h3 {
            color: #ff0000;
            margin-bottom: 15px;
            text-shadow: 0 0 5px #ff0000;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: #000000;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #ff0000;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.2);
        }
        .stat-number {
            font-size: 28px;
            color: #ff0000;
            font-weight: bold;
            margin-bottom: 5px;
            text-shadow: 0 0 10px #ff0000;
        }
        .stat-label {
            color: #cccccc;
            font-size: 12px;
        }
        .control-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }
        @media (max-width: 768px) {
            .control-panel {
                grid-template-columns: 1fr;
            }
        }
        .panel {
            background: #000000;
            border-radius: 10px;
            padding: 25px;
            border: 1px solid #ff0000;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
        }
        .panel h2 {
            color: #ff0000;
            margin-bottom: 20px;
            border-bottom: 1px solid #333333;
            padding-bottom: 10px;
            text-shadow: 0 0 5px #ff0000;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            color: #ff0000;
            margin-bottom: 5px;
            font-size: 14px;
        }
        .form-control {
            width: 100%;
            padding: 12px;
            background: #111111;
            border: 1px solid #ff0000;
            border-radius: 5px;
            color: #00ff00;
            font-family: 'Courier New', monospace;
        }
        .form-control:focus {
            border-color: #00ff00;
            box-shadow: 0 0 10px #00ff00;
            outline: none;
        }
        .btn {
            background: linear-gradient(135deg, #ff0000, #cc0000);
            color: #000000;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-family: 'Courier New', monospace;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
            border: 1px solid #ff0000;
        }
        .btn:hover {
            background: linear-gradient(135deg, #ff3333, #dd0000);
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.7);
            transform: translateY(-2px);
        }
        .btn-success {
            background: linear-gradient(135deg, #00ff00, #00aa00);
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.5);
            border: 1px solid #00ff00;
        }
        .btn-success:hover {
            background: linear-gradient(135deg, #33ff33, #00cc00);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.7);
        }
        .btn-block {
            width: 100%;
            margin-top: 10px;
        }
        .license-list {
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
        }
        .license-item {
            background: #111111;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
            border-left: 3px solid #ff0000;
        }
        .license-key {
            color: #ff0000;
            font-weight: bold;
            margin-bottom: 5px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            text-shadow: 0 0 5px #ff0000;
        }
        .license-info {
            color: #cccccc;
            font-size: 12px;
            margin-bottom: 3px;
        }
        .license-actions {
            margin-top: 10px;
        }
        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
            margin-right: 5px;
            background: #333333;
        }
        .btn-sm:hover {
            background: #555555;
        }
        .btn-danger {
            background: linear-gradient(135deg, #660000, #440000);
        }
        .btn-danger:hover {
            background: linear-gradient(135deg, #880000, #660000);
        }
        .status-active { color: #00ff00; text-shadow: 0 0 5px #00ff00; }
        .status-expired { color: #ff0000; text-shadow: 0 0 5px #ff0000; }
        .status-revoked { color: #ff4444; text-shadow: 0 0 5px #ff4444; }
        
        .matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            opacity: 0.1;
        }

        .debug-info {
            background: #111111;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #ff0000;
            margin-top: 20px;
            font-size: 12px;
            color: #cccccc;
        }
        .debug-info h4 {
            color: #ff0000;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <canvas class="matrix-bg" id="matrixCanvas"></canvas>

    <div class="admin-header">
        <h1>üîß ADMIN CONTROL PANEL</h1>
        <p>THE-F!X_King - Fully Functional License System</p>
    </div>

    <div class="config-section">
        <h3>‚öôÔ∏è System Status</h3>
        <div class="form-group">
            <label>Database: Local Storage</label>
            <div style="color: #00ff00; padding: 10px; background: rgba(0,255,0,0.1); border-radius: 5px;">
                ‚úÖ Secure Local Database Active
            </div>
        </div>
        <button class="btn btn-success" onclick="exportData()">üíæ Export Database</button>
        <button class="btn" onclick="importData()">üì• Import Database</button>
        <button class="btn btn-danger" onclick="clearAllData()">üóëÔ∏è Clear All Data</button>
        <div id="connectionStatus" style="margin-top: 10px; font-weight: bold;"></div>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-number" id="totalLicenses">0</div>
            <div class="stat-label">Total Licenses</div>
        </div>
        <div class="stat-card">
            <div class="stat-number" id="activeLicenses">0</div>
            <div class="stat-label">Active Licenses</div>
        </div>
        <div class="stat-card">
            <div class="stat-number" id="totalDevices">0</div>
            <div class="stat-label">Active Devices</div>
        </div>
        <div class="stat-card">
            <div class="stat-number" id="databaseStatus">‚úÖ</div>
            <div class="stat-label">System Status</div>
        </div>
    </div>

    <div class="control-panel">
        <div class="panel">
            <h2>üîë Generate License</h2>
            <div class="form-group">
                <label>Customer Name</label>
                <input type="text" class="form-control" id="customerName" placeholder="Enter customer name">
            </div>
            <div class="form-group">
                <label>Device Limit</label>
                <select class="form-control" id="deviceLimit">
                    <option value="1">1 Device</option>
                    <option value="2">2 Devices</option>
                    <option value="3" selected>3 Devices</option>
                    <option value="5">5 Devices</option>
                    <option value="10">10 Devices</option>
                </select>
            </div>
            <div class="form-group">
                <label>Expiry Days</label>
                <select class="form-control" id="expiryDays">
                    <option value="7">7 Days</option>
                    <option value="30" selected>30 Days</option>
                    <option value="90">90 Days</option>
                    <option value="365">1 Year</option>
                </select>
            </div>
            <button class="btn btn-block" onclick="generateLicense()">‚ö° GENERATE LICENSE</button>
            <div id="generatedKey" style="margin-top: 15px; padding: 15px; background: rgba(0, 255, 0, 0.1); border: 1px solid #00ff00; border-radius: 5px; display: none; color: #00ff00;"></div>
        </div>

        <div class="panel">
            <h2>üìä License Management</h2>
            <div class="license-list" id="licenseList">
                <p style="color: #666; text-align: center; padding: 20px;">No licenses generated yet</p>
            </div>
        </div>
    </div>

    <div class="debug-info">
        <h4>üîß System Information</h4>
        <div id="debugOutput">System ready - Local storage database active</div>
        <button class="btn btn-sm" onclick="clearDebug()" style="margin-top: 10px;">Clear Log</button>
    </div>

    <script>
        // Matrix Rain Effect
        function initMatrix() {
            const canvas = document.getElementById('matrixCanvas');
            const ctx = canvas.getContext('2d');
            
            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
            
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            
            const chars = "THE-F!X_King0123456789";
            const charArray = chars.split("");
            const fontSize = 12;
            const columns = canvas.width / fontSize;
            const drops = [];
            
            for(let i = 0; i < columns; i++) {
                drops[i] = Math.random() * canvas.height / fontSize;
            }
            
            function drawMatrix() {
                ctx.fillStyle = "rgba(0, 0, 0, 0.04)";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = "#00ff00";
                ctx.font = fontSize + "px 'Courier New'";
                
                for(let i = 0; i < drops.length; i++) {
                    const text = charArray[Math.floor(Math.random() * charArray.length)];
                    ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                    
                    if(drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                        drops[i] = 0;
                    }
                    drops[i]++;
                }
            }
            
            setInterval(drawMatrix, 35);
        }

        // License Database Management
        let licenses = JSON.parse(localStorage.getItem('THE-F!X_King_licenses')) || [];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initMatrix();
            updateStats();
            loadLicenses();
            showStatus('‚úÖ System initialized successfully', 'success');
            debugLog('Admin panel loaded - ' + licenses.length + ' licenses in database');
        });

        function debugLog(message) {
            const debugOutput = document.getElementById('debugOutput');
            const timestamp = new Date().toLocaleTimeString();
            debugOutput.innerHTML = `<div><strong>[${timestamp}]</strong> ${message}</div>` + debugOutput.innerHTML;
        }

        function clearDebug() {
            document.getElementById('debugOutput').innerHTML = 'Log cleared';
        }

        function showStatus(message, type) {
            const statusDiv = document.getElementById('connectionStatus');
            statusDiv.textContent = message;
            statusDiv.style.color = type === 'success' ? '#00ff00' : 
                                  type === 'error' ? '#ff0000' : '#ffff00';
            statusDiv.style.fontWeight = 'bold';
            
            setTimeout(() => {
                statusDiv.textContent = '';
            }, 5000);
        }

        // Generate unique license key
        function generateCustomKey() {
            const randomDigits = Math.floor(Math.random() * 90 + 10);
            const randomLetter = String.fromCharCode(65 + Math.floor(Math.random() * 26));
            return `THE-F!X_KING:${randomDigits}${randomLetter}`;
        }

        // Generate new license
        function generateLicense() {
            const customer = document.getElementById('customerName').value || 'Anonymous';
            const deviceLimit = parseInt(document.getElementById('deviceLimit').value);
            const expiryDays = parseInt(document.getElementById('expiryDays').value);
            
            const licenseKey = generateCustomKey();
            const expiryDate = new Date();
            expiryDate.setDate(expiryDate.getDate() + expiryDays);
            
            const newLicense = {
                key: licenseKey,
                customer: customer,
                deviceLimit: deviceLimit,
                usedDevices: 0,
                expiryDate: expiryDate.toISOString().split('T')[0],
                created: new Date().toISOString().split('T')[0],
                status: 'active',
                activations: []
            };
            
            licenses.unshift(newLicense);
            saveLicenses();
            
            updateStats();
            loadLicenses();
            
            const keyDiv = document.getElementById('generatedKey');
            keyDiv.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 10px;">‚úÖ LICENSE GENERATED</div>
                <div style="margin-bottom: 5px;"><strong>Key:</strong> <span style="font-family: 'Courier New';">${licenseKey}</span></div>
                <div style="margin-bottom: 5px;"><strong>Customer:</strong> ${customer}</div>
                <div style="margin-bottom: 5px;"><strong>Devices:</strong> ${deviceLimit}</div>
                <div style="margin-bottom: 5px;"><strong>Expires:</strong> ${newLicense.expiryDate}</div>
                <div style="margin-top: 10px; color: #ffa500; font-size: 12px;">
                    üìã Copy this key and share it with your customer
                </div>
            `;
            keyDiv.style.display = 'block';
            
            document.getElementById('customerName').value = '';
            
            debugLog(`Generated new license: ${licenseKey} for ${customer}`);
            showStatus('‚úÖ License generated successfully!', 'success');
        }

        // Save licenses to localStorage
        function saveLicenses() {
            localStorage.setItem('THE-F!X_King_licenses', JSON.stringify(licenses));
            debugLog(`Saved ${licenses.length} licenses to database`);
        }

        // Update statistics
        function updateStats() {
            const total = licenses.length;
            const active = licenses.filter(l => l.status === 'active' && new Date(l.expiryDate) >= new Date()).length;
            const devices = licenses.reduce((sum, l) => sum + (l.activations ? l.activations.length : 0), 0);
            
            document.getElementById('totalLicenses').textContent = total;
            document.getElementById('activeLicenses').textContent = active;
            document.getElementById('totalDevices').textContent = devices;
        }

        // Load licenses in UI
        function loadLicenses() {
            const container = document.getElementById('licenseList');
            
            if (licenses.length === 0) {
                container.innerHTML = '<p style="color: #666; text-align: center; padding: 20px;">No licenses yet. Generate your first license above.</p>';
                return;
            }
            
            container.innerHTML = '';
            
            licenses.forEach((license, index) => {
                const isExpired = new Date(license.expiryDate) < new Date();
                const status = isExpired ? 'expired' : license.status;
                const activationCount = license.activations ? license.activations.length : 0;
                
                const div = document.createElement('div');
                div.className = 'license-item';
                div.innerHTML = `
                    <div class="license-key">${license.key}</div>
                    <div class="license-info">
                        <strong>Customer:</strong> ${license.customer} | 
                        <strong>Devices:</strong> ${activationCount}/${license.deviceLimit}
                    </div>
                    <div class="license-info">
                        <strong>Expires:</strong> ${license.expiryDate} | 
                        <strong>Status:</strong> <span class="status-${status}">${status.toUpperCase()}</span>
                    </div>
                    <div class="license-info">
                        <strong>Created:</strong> ${license.created}
                    </div>
                    <div class="license-actions">
                        <button class="btn btn-sm" onclick="revokeLicense(${index})">Revoke</button>
                        <button class="btn btn-sm" onclick="extendLicense(${index}, 30)">+30 Days</button>
                        <button class="btn btn-sm" onclick="viewActivations(${index})">View Devices</button>
                        <button class="btn btn-sm btn-danger" onclick="deleteLicense(${index})">Delete</button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        // License actions
        function revokeLicense(index) {
            if (confirm('Revoke this license? User will lose access immediately.')) {
                licenses[index].status = 'revoked';
                saveLicenses();
                loadLicenses();
                updateStats();
                showStatus('‚úÖ License revoked', 'success');
                debugLog(`Revoked license: ${licenses[index].key}`);
            }
        }

        function extendLicense(index, days) {
            const newDate = new Date(licenses[index].expiryDate);
            newDate.setDate(newDate.getDate() + days);
            licenses[index].expiryDate = newDate.toISOString().split('T')[0];
            licenses[index].status = 'active';
            saveLicenses();
            loadLicenses();
            showStatus(`‚úÖ License extended by ${days} days`, 'success');
            debugLog(`Extended license: ${licenses[index].key} by ${days} days`);
        }

        function viewActivations(index) {
            const license = licenses[index];
            const activations = license.activations || [];
            alert(`Devices activated for ${license.key}:\n\n${activations.join('\n') || 'No devices activated yet'}`);
        }

        function deleteLicense(index) {
            if (confirm('Permanently delete this license?')) {
                const deletedKey = licenses[index].key;
                licenses.splice(index, 1);
                saveLicenses();
                loadLicenses();
                updateStats();
                showStatus('‚úÖ License deleted', 'success');
                debugLog(`Deleted license: ${deletedKey}`);
            }
        }

        // Data management functions
        function exportData() {
            const data = {
                licenses: licenses,
                exported: new Date().toISOString(),
                totalLicenses: licenses.length
            };
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'THE-F!X_King_licenses_backup.json';
            link.click();
            URL.revokeObjectURL(url);
            debugLog('Database exported successfully');
            showStatus('‚úÖ Database exported', 'success');
        }

        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = e => {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = event => {
                    try {
                        const data = JSON.parse(event.target.result);
                        if (data.licenses && Array.isArray(data.licenses)) {
                            licenses = data.licenses;
                            saveLicenses();
                            updateStats();
                            loadLicenses();
                            debugLog(`Imported ${licenses.length} licenses from backup`);
                            showStatus('‚úÖ Database imported successfully!', 'success');
                        } else {
                            throw new Error('Invalid file format');
                        }
                    } catch (error) {
                        showStatus('‚ùå Invalid backup file', 'error');
                        debugLog('Import failed: ' + error.message);
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }

        function clearAllData() {
            if (confirm('‚ö†Ô∏è DELETE ALL LICENSES AND DATA?\n\nThis action cannot be undone!')) {
                licenses = [];
                localStorage.removeItem('THE-F!X_King_licenses');
                updateStats();
                loadLicenses();
                debugLog('All data cleared from database');
                showStatus('üóëÔ∏è All data cleared', 'error');
            }
        }
    </script>
</body>
</html>
